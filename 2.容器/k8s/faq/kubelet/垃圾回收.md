### kubelet垃圾回收

`kubelet`每隔`1`分钟进行一次容器清理，每隔`5`分钟进行一次镜像清理

> 镜像回收流程

1. 调用运行时接口，获取存放镜像的文件系统信息，主要获取两个值:
- 文件系统磁盘总容量
- 文件系统磁盘可用容量
2. 计算磁盘使用率使用到达垃圾回收阈值（`--image-gc-high-threshold`），如果到达阈值启动镜像垃圾回收流程。
3. 启动垃圾回收流程后，首先计算出一个要释放出空间大小的值
4. `kubelet`对本地镜像进行排序，找到未被容器使用的镜像，调用运行时接口对其释放。
直到磁盘使用率降到设定下限（LowThresholdPercent）或没有空闲镜像可以清理。
此外，在进行镜像清理时，会考虑镜像的生存年龄(默认两分钟)，对于年龄没有达到最短生存年龄（MinAge）要求的镜像，暂不予以清理。



[K8s Kubelet 垃圾回收机制](https://www.jianshu.com/p/2085a49b8f04)